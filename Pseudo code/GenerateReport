IDENTIFICATION DIVISION.
PROGRAM-ID. GenerateReport.
AUTHOR. Udit Sharma.
DATE-WRITTEN. 2023-07-21.
DATE-COMPILED.
DATA DIVISION.
WORKING-STORAGE SECTION.
01 PolicyRecord.
   05 Policy-Number      // Policy number field
   05 Policy-Holder-Name // Policy holder name field
   05 Premium-Amount     // Premium amount field
   05 Policy-Type        // Policy type field
   05 Coverage-Limits    // Coverage limits field
   05 Policy-Premium     // Policy premium field
   05 Age                // Age of policy holder field
   05 Car-Value          // Value of the insured car field
   05 Property-Type      // Type of insured property field
   05 Property-Value     // Value of insured property field
   05 Coverage-Amount    // Coverage amount field

LINKAGE SECTION.
01 PolicyReportRecord.
   05 Policy-Number       // Policy number field
   05 Policy-Type         // Policy type field
   05 Policy-Holder-Name  // Policy holder name field
   05 Coverage-Limits     // Coverage limits field
   05 Policy-Premium      // Policy premium field
   05 Claim-Status        // Claim status field
   05 Age                 // Age of policy holder field
   05 Car-Value           // Value of the insured car field
   05 Property-Type       // Type of insured property field
   05 Property-Value      // Value of insured property field
   05 Coverage-Amount     // Coverage amount field

01 PolicySummaryReport.
   05 Total-Policies      // Total policies count
   05 Total-Premiums      // Total premiums sum
   05 Total-Claims        // Total claims count
   05 Total-Rejected-Claims // Total rejected claims count

PROCEDURE DIVISION USING PolicyReportRecord, PolicySummaryReport.
    DISPLAY "Generating policy summary report..."
    MOVE Policy-Premium TO Premium-Amount-Temp
    ADD Premium-Amount-Temp TO Total-Premiums
    ADD 1 TO Total-Policies

    IF Claim-Status = "PAY"
        ADD 1 TO Total-Claims
    ELSE
        ADD 1 TO Total-Rejected-Claims
    END-IF

    MOVE Policy-Number TO PolicyIMSRecord.Policy-Number-IMS
    MOVE Policy-Holder-Name TO PolicyIMSRecord.Policy-Data-IMS
    MOVE Policy-Type TO PolicyIMSRecord.Policy-Type-IMS
    MOVE Coverage-Limits TO PolicyIMSRecord.Coverage-Limits-IMS
    MOVE Policy-Premium TO PolicyIMSRecord.Policy-Premium-IMS
    MOVE Age TO PolicyIMSRecord.Age-IMS
    MOVE Car-Value TO PolicyIMSRecord.Car-Value-IMS
    MOVE Property-Type TO PolicyIMSRecord.Property-Type-IMS
    MOVE Property-Value TO PolicyIMSRecord.Property-Value-IMS
    MOVE Coverage-Amount TO PolicyIMSRecord.Coverage-Amount-IMS

    // Add other fields to PolicyIMSRecord as required for the report

    MOVE PolicyIMSRecord TO PolicyIMSFile
    WRITE PolicyIMSRecord TO PolicyIMSFile

    DISPLAY "Policy summary report generated."
    EXIT PROGRAM.
